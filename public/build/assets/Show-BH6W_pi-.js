import{k as Vt,l as C,f as m,b as a,t as b,d as st,n as It,F as P,m as F,o as f,p as Se,r as Xe,g as A,q as mt,e as E,h as X,s as Q,x as Ut,a as pt,c as at,y as ln,v as ue,w as dn,z as un}from"./app-DpIZmD6K.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";function cn(n,t,e,o){!n||!t||((n.title!==e.title||n.description!==e.description)&&o("board"),e.columns.forEach(i=>{const s=t.find(r=>r.id===i.id);if(!s){o("column",i.id);return}s.title!==i.title&&o("column",i.id),i.tasks.forEach(r=>{const d=s.tasks.find(l=>l.id===r.id);if(!d){o("card",r.id);return}(d.title!==r.title||d.description!==r.description||d.position!==r.position)&&o("card",r.id)})}))}function fn(n,t=null){mn(),n==="board"&&hn(),n==="column"&&pn(t),n==="card"&&gn(t)}let Nt=null;function mn(){Nt||(Nt=new(window.AudioContext||window.webkitAudioContext));const n=Nt.createBufferSource();fetch("/sounds/notify.mp3").then(t=>t.arrayBuffer()).then(t=>Nt.decodeAudioData(t)).then(t=>{n.buffer=t,n.connect(Nt.destination),n.start(0)})}function hn(){const n=document.querySelector("[data-board-root]");n&&Ee(n)}function pn(n){const t=document.querySelector(`[data-column-id="${n}"]`);t&&Ee(t)}function gn(n){const t=document.querySelector(`[data-card-id="${n}"]`);t&&Ee(t)}function Ee(n){n.classList.add("highlight"),setTimeout(()=>n.classList.remove("highlight"),3500)}const Ht=Vt("kanban",{state:()=>({board:null,columns:[],tags:[],loading:!1,taskPagination:{},error:null}),getters:{getColumnById:n=>t=>n.columns.find(e=>e.id===t),getTaskById:n=>t=>{for(const e of n.columns){const o=e.tasks.find(i=>i.id===t);if(o)return o}return null}},actions:{async renameBoard(n,t){const{data:e}=await C.put(`/api/boards/${n}`,{title:t});this.board.title=e.title},async loadTasks(n){let t=1;const e=this.taskPagination[n];e&&e.page<e.lastPage&&(console.log(e.page,e.lastPage),t=(e.page||1)+1);const{data:o}=await C.get(`/api/columns/${n}/tasks?page=${t}`),i=this.getColumnById(n);i&&(i.tasks=[...i.tasks,...o.data],this.taskPagination[n]={page:o.current_page,lastPage:o.last_page})},async createColumn(n,t){try{const{data:e}=await C.post(`/api/boards/${n}/columns`,{title:t});return this.columns.push({...e,tasks:[]}),e}catch(e){throw console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–ª–æ–Ω–∫–∏:",e),e}},async loadBoard(n){this.loading=!0,this.error=null;const t=JSON.parse(JSON.stringify(this.board)),e=JSON.parse(JSON.stringify(this.columns));try{const{data:o}=await C.get(`/api/boards/${n}`);cn(t,e,o,fn),this.board=o,this.columns=o.columns}catch(o){this.error="–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ—Å–∫—É",console.error(o)}finally{this.loading=!1}},async markTaskViewed(n){try{await C.post(`/api/tasks/${n}/view`);const t=this.columns.flatMap(e=>e.tasks).find(e=>e.id===n);t&&(t.last_viewed_at=new Date().toISOString())}catch(t){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–¥–∞—á–∏",t)}},async updateColumn(n,t){try{const{data:e}=await C.put(`/api/columns/${n}`,t),o=this.columns.findIndex(i=>i.id===n);o!==-1&&(this.columns[o]=e)}catch(e){console.error(e)}},async deleteColumn(n){try{await C.delete(`/api/columns/${n}`),this.columns=this.columns.filter(t=>t.id!==n)}catch(t){console.error(t)}},async clearBoard(){const n=this.columns.map(t=>t.id);for(const t of n)await this.deleteColumn(t)},async createTask(n,t){try{const{data:e}=await C.post(`/api/boards/${n}/tasks`,{column_id:t.columnId,title:t.title,description:t.description,priority:t.priority,due_date:t.dueDate,labels:t.labels??[],tag_ids:t.tagIds??[]}),o=this.getColumnById(e.column_id);return o&&o.tasks.unshift(e),e}catch(e){throw console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏:",e),e}},async updateTask(n){try{const{data:t}=await C.put(`/api/tasks/${n.id}`,{column_id:n.columnId,title:n.title,description:n.description,priority:n.priority,due_date:n.dueDate,labels:n.labels??[],tag_ids:n.tagIds??[]}),e=this.getColumnById(t.column_id);if(!e)return t;const o=e.tasks.findIndex(i=>i.id===t.id);return o!==-1&&(e.tasks[o]=t),t}catch(t){throw console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏:",t),t}},async deleteTask(n){try{await C.delete(`/api/tasks/${n}`),this.columns.forEach(t=>{t.tasks=t.tasks.filter(e=>e.id!==n)})}catch(t){console.error(t)}},async moveTask(n,t,e=0){try{await C.post("/api/tasks/move",{task_id:n,to_column_id:t,position:e});let o=null,i=null;if(this.columns.forEach(r=>{const d=r.tasks.find(l=>l.id===n);d&&(o=d,i=r)}),!o||!i)return;i.tasks=i.tasks.filter(r=>r.id!==n);const s=this.getColumnById(t);if(!s)return;s.tasks.push({...o,column_id:t})}catch(o){console.error(o)}},async renameColumn(n,t){try{const{data:e}=await C.put(`/api/columns/${n}`,{title:t}),o=this.columns.findIndex(i=>i.id===n);return o!==-1&&(this.columns[o].title=e.title),e}catch(e){throw console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ–ª–æ–Ω–∫–∏:",e),e}},async reorderTask(n,t,e){const o=this.getColumnById(e);if(!o)return;const i=[...o.tasks],s=i.findIndex(l=>l.id===n),r=i.findIndex(l=>l.id===t),[d]=i.splice(s,1);i.splice(r,0,d),o.tasks=i,await C.put(`/api/columns/${e}/tasks/reorder`,{order:i.map(l=>l.id)})},async duplicateTask(n){try{const{data:t}=await C.post(`/api/tasks/${n.id}/duplicate`),e=this.getColumnById(t.column_id);return e&&e.tasks.push(t),t}catch(t){throw console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏:",t),t}},async loadTags(n){const{data:t}=await C.get(`/api/boards/${n}/tags`);this.tags=t},async createTag(n,t,e="#999999"){const{data:o}=await C.post(`/api/boards/${n}/tags`,{name:t,color:e});return this.tags.push(o),o},async moveColumn(n,t){const e=[...this.columns],o=e.splice(n,1)[0];e.splice(t,0,o),this.columns=e;const i=this.columns.map(s=>s.id);return await C.put(`/api/boards/${this.board.uuid}/columns/reorder`,{order:i})},async deleteTag(n){await C.delete(`/api/tags/${n}`),this.tags=this.tags.filter(t=>t.id!==n)}}}),bn={props:{task:Object},data(){return{priority:{low:"–ù–∏–∑–∫–∏–π",medium:"–°—Ä–µ–¥–Ω–∏–π",high:"–í—ã—Å–æ–∫–∏–π"}}}},vn=["data-card-id"],yn={class:"d-flex justify-content-between align-items-start mb-1"},wn={style:{"line-height":"100%"}},kn={class:"dropdown"},_n={class:"dropdown-menu dropdown-menu-end"},Tn={class:"d-flex flex-wrap mt-2"};function Dn(n,t,e,o,i,s){return f(),m("div",{"data-card-id":e.task.id,draggable:"true",onDragstart:t[3]||(t[3]=r=>n.$emit("dragstart",e.task)),onDragover:t[4]||(t[4]=st(()=>{},["prevent"])),onDrop:t[5]||(t[5]=st(r=>n.$emit("drop",e.task),["stop"])),class:It([{"bg-warning bg-opacity-25":!e.task.last_viewed_at},"kanban-task p-2 mb-2 bg-white rounded shadow-sm"]),onDblclick:t[6]||(t[6]=r=>n.$emit("edit",e.task))},[a("div",yn,[a("strong",wn,b(e.task.title),1),a("div",kn,[t[8]||(t[8]=a("button",{class:"btn btn-sm btn-light dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},null,-1)),a("ul",_n,[a("li",null,[a("button",{class:"dropdown-item",onClick:t[0]||(t[0]=st(r=>n.$emit("edit",e.task),["stop"]))}," ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ")]),a("li",null,[a("button",{class:"dropdown-item",onClick:t[1]||(t[1]=st(r=>n.$emit("duplicate",e.task),["stop"]))}," üìÑ –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å ")]),t[7]||(t[7]=a("li",null,[a("hr",{class:"dropdown-divider"})],-1)),a("li",null,[a("button",{class:"dropdown-item text-danger",onClick:t[2]||(t[2]=st(r=>n.$emit("delete",e.task),["stop"]))}," üóëÔ∏è –£–¥–∞–ª–∏—Ç—å ")])])])]),a("div",{class:It([[e.task.priority==="low"?"bg-secondary":"",e.task.priority==="medium"?"bg-warning":"",e.task.priority==="high"?"bg-success":""],"small badge text-white"])},b(i.priority[e.task.priority]||"-"),3),(f(!0),m(P,null,F(e.task.labels,r=>(f(),m("span",{key:r,class:"badge bg-secondary me-2"},b(r),1))),128)),a("div",Tn,[(f(!0),m(P,null,F(e.task.tags,r=>(f(),m("span",{key:r.id,class:"bg-info badge",style:Se({background:r.color})}," #"+b(r.name),5))),128))])],42,vn)}const Sn=j(bn,[["render",Dn]]),En={name:"ConfirmModal",props:{show:{type:Boolean,required:!0},title:{type:String,default:"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ"},description:{type:String,default:""}},emits:["update:show","accept","reject"],methods:{accept(){this.$emit("accept"),this.$emit("update:show",!1)},reject(){this.$emit("reject"),this.$emit("update:show",!1)}}},Cn={key:0,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},In={class:"modal-dialog modal-dialog-centered"},xn={class:"modal-content"},$n={class:"modal-header"},Mn={class:"modal-title"},On={class:"modal-body"},An={class:"mb-0"},Pn={class:"modal-footer"};function Nn(n,t,e,o,i,s){return e.show?(f(),m("div",Cn,[a("div",In,[a("div",xn,[a("div",$n,[a("h5",Mn,b(e.title),1),a("button",{class:"btn-close",onClick:t[0]||(t[0]=(...r)=>s.reject&&s.reject(...r))})]),a("div",On,[a("p",An,b(e.description),1)]),a("div",Pn,[Xe(n.$slots,"buttons",{},()=>[a("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...r)=>s.reject&&s.reject(...r))}," –û—Ç–º–µ–Ω–∞ "),a("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...r)=>s.accept&&s.accept(...r))}," –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å ")],!0)])])])])):A("",!0)}const Ye=j(En,[["render",Nn],["__scopeId","data-v-3c662b64"]]),Bn={components:{KanbanTask:Sn,ConfirmModal:Ye},props:{column:Object},data(){return{showDeleteModal:!1,dragTask:null,editing:!1,localTitle:this.column.title}},setup(){return{store:Ht()}},computed:{canLoadMore(){const n=this.store.taskPagination[this.column.id]||null;return n?n&&n.page<n.lastPage:!1}},methods:{onTaskDrop(n){!this.dragTask||this.dragTask.id===n.id||(this.store.reorderTask(this.dragTask.id,n.id,this.column.id),this.dragTask=null)},loadMore(){this.store.loadTasks(this.column.id)},addTask(){this.$emit("add-task",this.column.id)},editTask(n){this.$emit("add-task",this.column.id,n)},deleteTask(n){this.store.deleteTask(n.id)},deleteColumn(){this.store.deleteColumn(this.column.id)},onDragStart(n){this.dragTask=n,event.dataTransfer.setData("taskId",n.id)},duplicateTask(n){this.store.duplicateTask(n)},onDrop(){const n=Number(event.dataTransfer.getData("taskId"));this.store.moveTask(n,this.column.id)},startEditing(){this.localTitle=this.column.title,this.editing=!0},async saveTitle(){this.localTitle.trim()&&(await this.store.renameColumn(this.column.id,this.localTitle),this.editing=!1)},cancelEditing(){this.localTitle=this.column.title,this.editing=!1}}},Fn=["data-column-id"],jn={class:"d-flex justify-content-between align-items-center mb-2"},Rn={class:"flex-grow-1 me-2"},Ln={class:"bg-primary small badge me-2"},Xn={key:1,class:"d-flex align-items-center gap-2"},Yn={class:"d-flex gap-1"},Wn={class:"kanban-tasks"};function Un(n,t,e,o,i,s){const r=mt("KanbanTask"),d=mt("ConfirmModal");return f(),m("div",{"data-column-id":e.column.id,class:"kanban-column p-3 bg-light rounded",onDragover:t[10]||(t[10]=st(()=>{},["prevent"])),onDrop:t[11]||(t[11]=(...l)=>s.onDrop&&s.onDrop(...l))},[Xe(n.$slots,"head"),a("div",jn,[a("div",Rn,[i.editing?(f(),m("div",Xn,[X(a("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.localTitle=l),class:"form-control form-control-sm",onKeyup:[t[2]||(t[2]=Ut((...l)=>s.saveTitle&&s.saveTitle(...l),["enter"])),t[3]||(t[3]=Ut((...l)=>s.cancelEditing&&s.cancelEditing(...l),["esc"]))],autofocus:""},null,544),[[Q,i.localTitle]]),a("button",{class:"btn btn-sm btn-primary",onClick:t[4]||(t[4]=(...l)=>s.saveTitle&&s.saveTitle(...l))}," ‚úî ")])):(f(),m("h4",{key:0,onDblclick:t[0]||(t[0]=(...l)=>s.startEditing&&s.startEditing(...l)),class:"column-title"},[a("span",Ln,"#"+b(e.column.thread),1),E(b(i.localTitle),1)],32))]),a("div",Yn,[a("button",{class:"btn btn-sm btn-primary",onClick:t[5]||(t[5]=(...l)=>s.addTask&&s.addTask(...l))},"+"),e.column.can_remove?(f(),m("button",{key:0,class:"btn btn-sm btn-danger",onClick:t[6]||(t[6]=l=>i.showDeleteModal=!0),title:"–£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É"}," üóëÔ∏è ")):A("",!0)])]),a("div",Wn,[(f(!0),m(P,null,F(e.column.tasks,l=>(f(),at(r,{key:l.id,task:l,draggable:"true",onDragstart:u=>s.onDragStart(l),onEdit:s.editTask,onDrop:u=>s.onTaskDrop(l),onDuplicate:s.duplicateTask,onDelete:s.deleteTask},null,8,["task","onDragstart","onEdit","onDrop","onDuplicate","onDelete"]))),128)),s.canLoadMore?(f(),m("button",{key:0,class:"btn btn-sm btn-secondary w-100 mt-2",onClick:t[7]||(t[7]=(...l)=>s.loadMore&&s.loadMore(...l))}," –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë ")):A("",!0)]),pt(d,{show:i.showDeleteModal,"onUpdate:show":t[8]||(t[8]=l=>i.showDeleteModal=l),title:"–£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É?",description:"–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –∫–æ–ª–æ–Ω–∫—É –∏ –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –¥–∞–Ω–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ.",onAccept:s.deleteColumn,onReject:t[9]||(t[9]=l=>i.showDeleteModal=!1)},null,8,["show","onAccept"])],40,Fn)}const Vn=j(Bn,[["render",Un]]),Hn={props:{card:Object}},Kn={class:"my-2"},Gn={class:"list-group"},zn={class:"list-group-item"},qn={class:"list-group-item"},Jn={class:"list-group-item"},Zn={class:"list-group-item"},Qn={class:"list-group-item"},to={class:"list-group-item"};function eo(n,t,e,o,i,s){return f(),m("div",Kn,[t[6]||(t[6]=a("h5",{class:"mb-3"},"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ",-1)),a("ul",Gn,[a("li",zn,[t[0]||(t[0]=a("strong",null,"–¢–µ–ª–µ—Ñ–æ–Ω:",-1)),E(" "+b(e.card.data.phone),1)]),a("li",qn,[t[1]||(t[1]=a("strong",null,"Email:",-1)),E(" "+b(e.card.data.email),1)]),a("li",Jn,[t[2]||(t[2]=a("strong",null,"–ì–æ—Ä–æ–¥:",-1)),E(" "+b(e.card.data.city),1)]),a("li",Zn,[t[3]||(t[3]=a("strong",null,"–ö–æ–º–ø–∞–Ω–∏—è:",-1)),E(" "+b(e.card.data.company),1)]),a("li",Qn,[t[4]||(t[4]=a("strong",null,"–î–æ–ª–∂–Ω–æ—Å—Ç—å:",-1)),E(" "+b(e.card.data.position),1)]),a("li",to,[t[5]||(t[5]=a("strong",null,"–ó–∞–º–µ—Ç–∫–∏:",-1)),E(" "+b(e.card.data.notes),1)])])])}const no=j(Hn,[["render",eo]]),oo={props:{card:Object}},io={class:"my-2"},so={class:"list-group mb-3"},ao={class:"list-group-item"},ro={class:"list-group-item"},lo={class:"list-group-item"},uo={class:"list-group-item"},co={class:"list-group-item"},fo={class:"list-group-item"},mo={class:"list-group"};function ho(n,t,e,o,i,s){return f(),m("div",io,[t[6]||(t[6]=a("h5",{class:"mb-3"},"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ",-1)),a("ul",so,[a("li",ao,[t[0]||(t[0]=a("strong",null,"–¢–æ–≤–∞—Ä:",-1)),E(" "+b(e.card.data.product),1)]),a("li",ro,[t[1]||(t[1]=a("strong",null,"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:",-1)),E(" "+b(e.card.data.quantity),1)]),a("li",lo,[t[2]||(t[2]=a("strong",null,"–¶–µ–Ω–∞:",-1)),E(" "+b(e.card.data.price)+" ‚ÇΩ",1)]),a("li",uo,[t[3]||(t[3]=a("strong",null,"–°–∫–∏–¥–∫–∞:",-1)),E(" "+b(e.card.data.discount),1)]),a("li",co,[t[4]||(t[4]=a("strong",null,"–ê–¥—Ä–µ—Å:",-1)),E(" "+b(e.card.data.address),1)]),a("li",fo,[t[5]||(t[5]=a("strong",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:",-1)),E(" "+b(e.card.data.comment),1)])]),t[7]||(t[7]=a("h6",null,"–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞",-1)),a("ul",mo,[(f(!0),m(P,null,F(e.card.data.parts,r=>(f(),m("li",{key:r.name,class:"list-group-item"},b(r.name)+" ‚Äî "+b(r.amount),1))),128))])])}const po=j(oo,[["render",ho]]),go={props:{card:Object}},bo={class:"my-2"},vo={class:"mb-3"};function yo(n,t,e,o,i,s){return f(),m("div",bo,[t[2]||(t[2]=a("h5",{class:"mb-3"},"–í–æ–ø—Ä–æ—Å / –û—Ç–≤–µ—Ç",-1)),a("div",vo,[t[0]||(t[0]=a("strong",null,"–í–æ–ø—Ä–æ—Å:",-1)),a("p",null,b(e.card.data.question),1)]),a("div",null,[t[1]||(t[1]=a("strong",null,"–û—Ç–≤–µ—Ç:",-1)),a("p",null,b(e.card.data.answer),1)])])}const wo=j(go,[["render",yo]]),ko={props:{card:Object}},_o={class:"my-2"},To={class:"list-group"},Do={class:"list-group-item"},So={class:"list-group-item"},Eo={class:"list-group-item"},Co={class:"list-group-item"};function Io(n,t,e,o,i,s){return f(),m("div",_o,[t[4]||(t[4]=a("h5",{class:"mb-3"},"–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è",-1)),a("ul",To,[a("li",Do,[t[0]||(t[0]=a("strong",null,"–°—É–º–º–∞:",-1)),E(" "+b(e.card.data.amount)+" "+b(e.card.data.currency),1)]),a("li",So,[t[1]||(t[1]=a("strong",null,"–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:",-1)),E(" "+b(e.card.data.operation),1)]),a("li",Eo,[t[2]||(t[2]=a("strong",null,"–ë–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ:",-1)),E(" "+b(e.card.data.balanceAfter),1)]),a("li",Co,[t[3]||(t[3]=a("strong",null,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:",-1)),E(" "+b(e.card.data.comment),1)])])])}const xo=j(ko,[["render",Io]]),$o={props:{card:Object}},Mo={class:"my-2"},Oo={class:"list-group mb-3"},Ao={class:"list-group-item"},Po={class:"list-group-item"},No={class:"list-group mb-3"},Bo={class:"list-group"},Fo=["checked"];function jo(n,t,e,o,i,s){return f(),m("div",Mo,[t[2]||(t[2]=a("h5",{class:"mb-3"},"–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",-1)),a("ul",Oo,[a("li",Ao,[t[0]||(t[0]=a("strong",null,"–ú–µ–Ω–µ–¥–∂–µ—Ä:",-1)),E(" "+b(e.card.data.manager),1)]),a("li",Po,[t[1]||(t[1]=a("strong",null,"–î–µ–¥–ª–∞–π–Ω:",-1)),E(" "+b(e.card.data.deadline),1)])]),t[3]||(t[3]=a("h6",null,"–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",-1)),a("ul",No,[(f(!0),m(P,null,F(e.card.data.tech,r=>(f(),m("li",{key:r,class:"list-group-item"},b(r),1))),128))]),t[4]||(t[4]=a("h6",null,"–ü–æ–¥–∑–∞–¥–∞—á–∏",-1)),a("ul",Bo,[(f(!0),m(P,null,F(e.card.subtasks,r=>(f(),m("li",{key:r.id,class:It(["list-group-item",{"bg-success bg-opacity-10":r.done}])},[a("input",{type:"checkbox",class:"form-check-input me-2",checked:r.done,disabled:""},null,8,Fo),E(" "+b(r.text),1)],2))),128))])])}const Ro=j($o,[["render",jo]]),We=Vt("comments",{state:()=>({comments:[],loading:!1}),actions:{async fetchComments(n){this.loading=!0;const{data:t}=await C.get(`/api/task/${n}/comments`);this.comments=t,this.loading=!1},async addComment(n,t){var i;const e=new FormData;t.text&&e.append("text",t.text),t.author&&e.append("author",t.author),(i=t.files)!=null&&i.length&&t.files.forEach(s=>e.append("files[]",s));const{data:o}=await C.post(`/api/task/${n}/comment`,e,{headers:{"Content-Type":"multipart/form-data"}});this.comments.push(o)}}}),Lo={name:"CommentsList",props:{taskId:{type:Number,required:!0}},data(){return{store:We()}},mounted(){this.store.fetchComments(this.taskId)}},Xo={key:0},Yo={class:"comment-header"},Wo={class:"date"},Uo={key:0,class:"comment-text"},Vo={key:1,class:"attachments"},Ho=["src"],Ko={key:1,controls:"",class:"preview-video"},Go=["src","type"],zo={key:2,controls:""},qo=["src","type"],Jo=["href"];function Zo(n,t,e,o,i,s){return f(),m("div",null,[i.store.loading?(f(),m("div",Xo,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤...")):A("",!0),(f(!0),m(P,null,F(i.store.comments,r=>{var d;return f(),m("div",{key:r.id,class:"comment-item"},[a("div",Yo,[a("strong",null,b(r.author||"–ë–µ–∑ –∞–≤—Ç–æ—Ä–∞"),1),a("span",Wo,b(new Date(r.created_at).toLocaleString()),1)]),r.text?(f(),m("div",Uo,b(r.text),1)):A("",!0),(d=r.attachments)!=null&&d.length?(f(),m("div",Vo,[(f(!0),m(P,null,F(r.attachments,l=>(f(),m("div",{key:l.path,class:"attachment"},[l.mime.startsWith("image/")?(f(),m("img",{key:0,src:`/storage/${l.path}`,class:"preview-image"},null,8,Ho)):l.mime.startsWith("video/")?(f(),m("video",Ko,[a("source",{src:`/storage/${l.path}`,type:l.mime},null,8,Go)])):l.mime.startsWith("audio/")?(f(),m("audio",zo,[a("source",{src:`/storage/${l.path}`,type:l.mime},null,8,qo)])):(f(),m("a",{key:3,href:`/storage/${l.path}`,target:"_blank",class:"doc-link"}," üìÑ "+b(l.name),9,Jo))]))),128))])):A("",!0),t[0]||(t[0]=a("hr",null,null,-1))])}),128))])}const Qo=j(Lo,[["render",Zo],["__scopeId","data-v-467e2049"]]),ti={name:"CommentAddForm",props:{taskId:{type:Number,required:!0}},data(){return{author:"",text:"",files:[],store:We()}},methods:{onFilesSelected(n){this.files=Array.from(n.target.files)},async submit(){await this.store.addComment(this.taskId,{text:this.text,files:this.files,author:"–°–∏—Å—Ç–µ–º–∞"}),this.text="",this.files=[]}}},ei={class:"comment-add"},ni={class:"row"},oi={class:"col-4"},ii={class:"form-floating mb-2"},si={class:"form-floating"},ai={key:0,class:"previews"};function ri(n,t,e,o,i,s){return f(),m("div",ei,[a("div",ni,[a("div",oi,[a("div",ii,[X(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>i.author=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[Q,i.author]]),t[4]||(t[4]=a("label",{for:"floatingInput"},"–ò–º—è –∞–≤—Ç–æ—Ä–∞",-1))])])]),a("div",si,[X(a("textarea",{"onUpdate:modelValue":t[1]||(t[1]=r=>i.text=r),class:"form-control",placeholder:"–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."},null,512),[[Q,i.text]]),t[5]||(t[5]=a("label",{for:"floatingTextarea"},"–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...",-1))]),a("input",{type:"file",multiple:"",onChange:t[2]||(t[2]=(...r)=>s.onFilesSelected&&s.onFilesSelected(...r)),class:"form-control mt-2"},null,32),i.files.length?(f(),m("div",ai,[(f(!0),m(P,null,F(i.files,r=>(f(),m("div",{key:r.name,class:"preview-item"},b(r.name),1))),128))])):A("",!0),a("button",{class:"btn btn-primary mt-2",onClick:t[3]||(t[3]=(...r)=>s.submit&&s.submit(...r))}," –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ")])}const li=j(ti,[["render",ri],["__scopeId","data-v-5c3e5847"]]),Ue=Vt("taskAttachments",{state:()=>({attachments:[],loading:!1}),actions:{async fetch(n){this.loading=!0;const{data:t}=await C.get(`/api/task/${n}/attachments`);this.attachments=t.attachments||[],this.loading=!1},async upload(n,t){const e=new FormData;t.forEach(i=>e.append("files[]",i));const{data:o}=await C.post(`/api/task/${n}/attachments`,e,{headers:{"Content-Type":"multipart/form-data"}});this.attachments=o}}}),di={name:"TaskAttachmentsList",props:{taskId:{type:Number,required:!0}},data(){return{store:Ue()}},mounted(){this.store.fetch(this.taskId)}},ui={key:0},ci=["src"],fi={key:1,controls:"",class:"preview-video"},mi=["src","type"],hi={key:2,controls:""},pi=["src","type"],gi=["href"];function bi(n,t,e,o,i,s){return f(),m("div",null,[i.store.loading?(f(),m("div",ui,"–ó–∞–≥—Ä—É–∑–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π...")):A("",!0),(f(!0),m(P,null,F(i.store.attachments,r=>(f(),m("div",{key:r.path,class:"attachment"},[r.mime.startsWith("image/")?(f(),m("img",{key:0,src:`/storage/${r.path}`,class:"preview-image"},null,8,ci)):r.mime.startsWith("video/")?(f(),m("video",fi,[a("source",{src:`/storage/${r.path}`,type:r.mime},null,8,mi)])):r.mime.startsWith("audio/")?(f(),m("audio",hi,[a("source",{src:`/storage/${r.path}`,type:r.mime},null,8,pi)])):(f(),m("a",{key:3,href:`/storage/${r.path}`,target:"_blank",class:"doc-link"}," üìÑ "+b(r.name),9,gi))]))),128))])}const vi=j(di,[["render",bi],["__scopeId","data-v-96518a36"]]),yi={name:"TaskAttachmentsUpload",props:{taskId:{type:Number,required:!0}},data(){return{files:[],store:Ue()}},methods:{onFilesSelected(n){this.files=Array.from(n.target.files)},async upload(){await this.store.upload(this.taskId,this.files),this.files=[]}}},wi={class:"attachment-upload"},ki={key:0,class:"preview-list"};function _i(n,t,e,o,i,s){return f(),m("div",wi,[a("input",{type:"file",multiple:"",onChange:t[0]||(t[0]=(...r)=>s.onFilesSelected&&s.onFilesSelected(...r)),class:"form-control"},null,32),i.files.length?(f(),m("div",ki,[(f(!0),m(P,null,F(i.files,r=>(f(),m("div",{key:r.name,class:"preview-item"},b(r.name),1))),128))])):A("",!0),a("button",{class:"btn btn-primary mt-2",onClick:t[1]||(t[1]=(...r)=>s.upload&&s.upload(...r))}," –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã ")])}const Ti=j(yi,[["render",_i],["__scopeId","data-v-4901d944"]]);/**!
 * Sortable 1.15.7
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Di(n,t,e){return(t=Ii(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function lt(){return lt=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)({}).hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},lt.apply(null,arguments)}function Oe(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,o)}return e}function nt(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Oe(Object(e),!0).forEach(function(o){Di(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Oe(Object(e)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}function Si(n,t){if(n==null)return{};var e,o,i=Ei(n,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(o=0;o<s.length;o++)e=s[o],t.indexOf(e)===-1&&{}.propertyIsEnumerable.call(n,e)&&(i[e]=n[e])}return i}function Ei(n,t){if(n==null)return{};var e={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(t.indexOf(o)!==-1)continue;e[o]=n[o]}return e}function Ci(n,t){if(typeof n!="object"||!n)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var o=e.call(n,t);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function Ii(n){var t=Ci(n,"string");return typeof t=="symbol"?t:t+""}function we(n){"@babel/helpers - typeof";return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(n)}var xi="1.15.7";function rt(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var dt=rt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Kt=rt(/Edge/i),Ae=rt(/firefox/i),Rt=rt(/safari/i)&&!rt(/chrome/i)&&!rt(/android/i),Ce=rt(/iP(ad|od|hone)/i),Ve=rt(/chrome/i)&&rt(/android/i),He={capture:!1,passive:!1};function T(n,t,e){n.addEventListener(t,e,!dt&&He)}function k(n,t,e){n.removeEventListener(t,e,!dt&&He)}function ie(n,t){if(t){if(t[0]===">"&&(t=t.substring(1)),n)try{if(n.matches)return n.matches(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t)}catch{return!1}return!1}}function Ke(n){return n.host&&n!==document&&n.host.nodeType&&n.host!==n?n.host:n.parentNode}function Z(n,t,e,o){if(n){e=e||document;do{if(t!=null&&(t[0]===">"?n.parentNode===e&&ie(n,t):ie(n,t))||o&&n===e)return n;if(n===e)break}while(n=Ke(n))}return null}var Pe=/\s+/g;function H(n,t,e){if(n&&t)if(n.classList)n.classList[e?"add":"remove"](t);else{var o=(" "+n.className+" ").replace(Pe," ").replace(" "+t+" "," ");n.className=(o+(e?" "+t:"")).replace(Pe," ")}}function v(n,t,e){var o=n&&n.style;if(o){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(e=n.currentStyle),t===void 0?e:e[t];!(t in o)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),o[t]=e+(typeof e=="string"?"":"px")}}function Ct(n,t){var e="";if(typeof n=="string")e=n;else do{var o=v(n,"transform");o&&o!=="none"&&(e=o+" "+e)}while(!t&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(e)}function Ge(n,t,e){if(n){var o=n.getElementsByTagName(t),i=0,s=o.length;if(e)for(;i<s;i++)e(o[i],i);return o}return[]}function et(){var n=document.scrollingElement;return n||document.documentElement}function O(n,t,e,o,i){if(!(!n.getBoundingClientRect&&n!==window)){var s,r,d,l,u,g,h;if(n!==window&&n.parentNode&&n!==et()?(s=n.getBoundingClientRect(),r=s.top,d=s.left,l=s.bottom,u=s.right,g=s.height,h=s.width):(r=0,d=0,l=window.innerHeight,u=window.innerWidth,g=window.innerHeight,h=window.innerWidth),(t||e)&&n!==window&&(i=i||n.parentNode,!dt))do if(i&&i.getBoundingClientRect&&(v(i,"transform")!=="none"||e&&v(i,"position")!=="static")){var p=i.getBoundingClientRect();r-=p.top+parseInt(v(i,"border-top-width")),d-=p.left+parseInt(v(i,"border-left-width")),l=r+s.height,u=d+s.width;break}while(i=i.parentNode);if(o&&n!==window){var D=Ct(i||n),_=D&&D.a,S=D&&D.d;D&&(r/=S,d/=_,h/=_,g/=S,l=r+g,u=d+h)}return{top:r,left:d,bottom:l,right:u,width:h,height:g}}}function Ne(n,t,e){for(var o=gt(n,!0),i=O(n)[t];o;){var s=O(o)[e],r=void 0;if(r=i>=s,!r)return o;if(o===et())break;o=gt(o,!1)}return!1}function xt(n,t,e,o){for(var i=0,s=0,r=n.children;s<r.length;){if(r[s].style.display!=="none"&&r[s]!==y.ghost&&(o||r[s]!==y.dragged)&&Z(r[s],e.draggable,n,!1)){if(i===t)return r[s];i++}s++}return null}function Ie(n,t){for(var e=n.lastElementChild;e&&(e===y.ghost||v(e,"display")==="none"||t&&!ie(e,t));)e=e.previousElementSibling;return e||null}function G(n,t){var e=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==y.clone&&(!t||ie(n,t))&&e++;return e}function Be(n){var t=0,e=0,o=et();if(n)do{var i=Ct(n),s=i.a,r=i.d;t+=n.scrollLeft*s,e+=n.scrollTop*r}while(n!==o&&(n=n.parentNode));return[t,e]}function $i(n,t){for(var e in n)if(n.hasOwnProperty(e)){for(var o in t)if(t.hasOwnProperty(o)&&t[o]===n[e][o])return Number(e)}return-1}function gt(n,t){if(!n||!n.getBoundingClientRect)return et();var e=n,o=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var i=v(e);if(e.clientWidth<e.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return et();if(o||t)return e;o=!0}}while(e=e.parentNode);return et()}function Mi(n,t){if(n&&t)for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function ce(n,t){return Math.round(n.top)===Math.round(t.top)&&Math.round(n.left)===Math.round(t.left)&&Math.round(n.height)===Math.round(t.height)&&Math.round(n.width)===Math.round(t.width)}var Lt;function ze(n,t){return function(){if(!Lt){var e=arguments,o=this;e.length===1?n.call(o,e[0]):n.apply(o,e),Lt=setTimeout(function(){Lt=void 0},t)}}}function Oi(){clearTimeout(Lt),Lt=void 0}function qe(n,t,e){n.scrollLeft+=t,n.scrollTop+=e}function Je(n){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(n).cloneNode(!0):e?e(n).clone(!0)[0]:n.cloneNode(!0)}function Ze(n,t,e){var o={};return Array.from(n.children).forEach(function(i){var s,r,d,l;if(!(!Z(i,t.draggable,n,!1)||i.animated||i===e)){var u=O(i);o.left=Math.min((s=o.left)!==null&&s!==void 0?s:1/0,u.left),o.top=Math.min((r=o.top)!==null&&r!==void 0?r:1/0,u.top),o.right=Math.max((d=o.right)!==null&&d!==void 0?d:-1/0,u.right),o.bottom=Math.max((l=o.bottom)!==null&&l!==void 0?l:-1/0,u.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var W="Sortable"+new Date().getTime();function Ai(){var n=[],t;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(i){if(!(v(i,"display")==="none"||i===y.ghost)){n.push({target:i,rect:O(i)});var s=nt({},n[n.length-1].rect);if(i.thisAnimationDuration){var r=Ct(i,!0);r&&(s.top-=r.f,s.left-=r.e)}i.fromRect=s}})}},addAnimationState:function(o){n.push(o)},removeAnimationState:function(o){n.splice($i(n,{target:o}),1)},animateAll:function(o){var i=this;if(!this.options.animation){clearTimeout(t),typeof o=="function"&&o();return}var s=!1,r=0;n.forEach(function(d){var l=0,u=d.target,g=u.fromRect,h=O(u),p=u.prevFromRect,D=u.prevToRect,_=d.rect,S=Ct(u,!0);S&&(h.top-=S.f,h.left-=S.e),u.toRect=h,u.thisAnimationDuration&&ce(p,h)&&!ce(g,h)&&(_.top-h.top)/(_.left-h.left)===(g.top-h.top)/(g.left-h.left)&&(l=Ni(_,p,D,i.options)),ce(h,g)||(u.prevFromRect=g,u.prevToRect=h,l||(l=i.options.animation),i.animate(u,_,h,l)),l&&(s=!0,r=Math.max(r,l),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},l),u.thisAnimationDuration=l)}),clearTimeout(t),s?t=setTimeout(function(){typeof o=="function"&&o()},r):typeof o=="function"&&o(),n=[]},animate:function(o,i,s,r){if(r){v(o,"transition",""),v(o,"transform","");var d=Ct(this.el),l=d&&d.a,u=d&&d.d,g=(i.left-s.left)/(l||1),h=(i.top-s.top)/(u||1);o.animatingX=!!g,o.animatingY=!!h,v(o,"transform","translate3d("+g+"px,"+h+"px,0)"),this.forRepaintDummy=Pi(o),v(o,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),v(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){v(o,"transition",""),v(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},r)}}}}function Pi(n){return n.offsetWidth}function Ni(n,t,e,o){return Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*o.animation}var Tt=[],fe={initializeByDefault:!0},Gt={mount:function(t){for(var e in fe)fe.hasOwnProperty(e)&&!(e in t)&&(t[e]=fe[e]);Tt.forEach(function(o){if(o.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Tt.push(t)},pluginEvent:function(t,e,o){var i=this;this.eventCanceled=!1,o.cancel=function(){i.eventCanceled=!0};var s=t+"Global";Tt.forEach(function(r){e[r.pluginName]&&(e[r.pluginName][s]&&e[r.pluginName][s](nt({sortable:e},o)),e.options[r.pluginName]&&e[r.pluginName][t]&&e[r.pluginName][t](nt({sortable:e},o)))})},initializePlugins:function(t,e,o,i){Tt.forEach(function(d){var l=d.pluginName;if(!(!t.options[l]&&!d.initializeByDefault)){var u=new d(t,e,t.options);u.sortable=t,u.options=t.options,t[l]=u,lt(o,u.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var r=this.modifyOption(t,s,t.options[s]);typeof r<"u"&&(t.options[s]=r)}},getEventProperties:function(t,e){var o={};return Tt.forEach(function(i){typeof i.eventProperties=="function"&&lt(o,i.eventProperties.call(e[i.pluginName],t))}),o},modifyOption:function(t,e,o){var i;return Tt.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[e]=="function"&&(i=s.optionListeners[e].call(t[s.pluginName],o))}),i}};function Bi(n){var t=n.sortable,e=n.rootEl,o=n.name,i=n.targetEl,s=n.cloneEl,r=n.toEl,d=n.fromEl,l=n.oldIndex,u=n.newIndex,g=n.oldDraggableIndex,h=n.newDraggableIndex,p=n.originalEvent,D=n.putSortable,_=n.extraEventProperties;if(t=t||e&&e[W],!!t){var S,z=t.options,ot="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!dt&&!Kt?S=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(o,!0,!0)),S.to=r||e,S.from=d||e,S.item=i||e,S.clone=s,S.oldIndex=l,S.newIndex=u,S.oldDraggableIndex=g,S.newDraggableIndex=h,S.originalEvent=p,S.pullMode=D?D.lastPutMode:void 0;var R=nt(nt({},_),Gt.getEventProperties(o,t));for(var q in R)S[q]=R[q];e&&e.dispatchEvent(S),z[ot]&&z[ot].call(t,S)}}var Fi=["evt"],Y=function(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.evt,s=Si(o,Fi);Gt.pluginEvent.bind(y)(t,e,nt({dragEl:c,parentEl:$,ghostEl:w,rootEl:I,nextEl:_t,lastDownEl:te,cloneEl:x,cloneHidden:ht,dragStarted:Bt,putSortable:N,activeSortable:y.active,originalEvent:i,oldIndex:Et,oldDraggableIndex:Xt,newIndex:K,newDraggableIndex:ft,hideGhostForTarget:nn,unhideGhostForTarget:on,cloneNowHidden:function(){ht=!0},cloneNowShown:function(){ht=!1},dispatchSortableEvent:function(d){L({sortable:e,name:d,originalEvent:i})}},s))};function L(n){Bi(nt({putSortable:N,cloneEl:x,targetEl:c,rootEl:I,oldIndex:Et,oldDraggableIndex:Xt,newIndex:K,newDraggableIndex:ft},n))}var c,$,w,I,_t,te,x,ht,Et,K,Xt,ft,qt,N,St=!1,se=!1,ae=[],wt,J,me,he,Fe,je,Bt,Dt,Yt,Wt=!1,Jt=!1,ee,B,pe=[],ke=!1,re=[],de=typeof document<"u",Zt=Ce,Re=Kt||dt?"cssFloat":"float",ji=de&&!Ve&&!Ce&&"draggable"in document.createElement("div"),Qe=function(){if(de){if(dt)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),tn=function(t,e){var o=v(t),i=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),s=xt(t,0,e),r=xt(t,1,e),d=s&&v(s),l=r&&v(r),u=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+O(s).width,g=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+O(r).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&d.float&&d.float!=="none"){var h=d.float==="left"?"left":"right";return r&&(l.clear==="both"||l.clear===h)?"vertical":"horizontal"}return s&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||u>=i&&o[Re]==="none"||r&&o[Re]==="none"&&u+g>i)?"vertical":"horizontal"},Ri=function(t,e,o){var i=o?t.left:t.top,s=o?t.right:t.bottom,r=o?t.width:t.height,d=o?e.left:e.top,l=o?e.right:e.bottom,u=o?e.width:e.height;return i===d||s===l||i+r/2===d+u/2},Li=function(t,e){var o;return ae.some(function(i){var s=i[W].options.emptyInsertThreshold;if(!(!s||Ie(i))){var r=O(i),d=t>=r.left-s&&t<=r.right+s,l=e>=r.top-s&&e<=r.bottom+s;if(d&&l)return o=i}}),o},en=function(t){function e(s,r){return function(d,l,u,g){var h=d.options.group.name&&l.options.group.name&&d.options.group.name===l.options.group.name;if(s==null&&(r||h))return!0;if(s==null||s===!1)return!1;if(r&&s==="clone")return s;if(typeof s=="function")return e(s(d,l,u,g),r)(d,l,u,g);var p=(r?d:l).options.group.name;return s===!0||typeof s=="string"&&s===p||s.join&&s.indexOf(p)>-1}}var o={},i=t.group;(!i||we(i)!="object")&&(i={name:i}),o.name=i.name,o.checkPull=e(i.pull,!0),o.checkPut=e(i.put),o.revertClone=i.revertClone,t.group=o},nn=function(){!Qe&&w&&v(w,"display","none")},on=function(){!Qe&&w&&v(w,"display","")};de&&!Ve&&document.addEventListener("click",function(n){if(se)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),se=!1,!1},!0);var kt=function(t){if(c){t=t.touches?t.touches[0]:t;var e=Li(t.clientX,t.clientY);if(e){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[W]._onDragOver(o)}}},Xi=function(t){c&&c.parentNode[W]._isOutsideThisEl(t.target)};function y(n,t){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=t=lt({},t),n[W]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return tn(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,d){r.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:y.supportPointer!==!1&&"PointerEvent"in window&&(!Rt||Ce),emptyInsertThreshold:5};Gt.initializePlugins(this,n,e);for(var o in e)!(o in t)&&(t[o]=e[o]);en(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:ji,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?T(n,"pointerdown",this._onTapStart):(T(n,"mousedown",this._onTapStart),T(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(T(n,"dragover",this),T(n,"dragenter",this)),ae.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),lt(this,Ai())}y.prototype={constructor:y,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Dt=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,c):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,o=this.el,i=this.options,s=i.preventOnFilter,r=t.type,d=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(d||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,g=i.filter;if(zi(o),!c&&!(/mousedown|pointerdown/.test(r)&&t.button!==0||i.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Rt&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Z(l,i.draggable,o,!1),!(l&&l.animated)&&te!==l)){if(Et=G(l),Xt=G(l,i.draggable),typeof g=="function"){if(g.call(this,t,l,this)){L({sortable:e,rootEl:u,name:"filter",targetEl:l,toEl:o,fromEl:o}),Y("filter",e,{evt:t}),s&&t.preventDefault();return}}else if(g&&(g=g.split(",").some(function(h){if(h=Z(u,h.trim(),o,!1),h)return L({sortable:e,rootEl:h,name:"filter",targetEl:l,fromEl:o,toEl:o}),Y("filter",e,{evt:t}),!0}),g)){s&&t.preventDefault();return}i.handle&&!Z(u,i.handle,o,!1)||this._prepareDragStart(t,d,l)}}},_prepareDragStart:function(t,e,o){var i=this,s=i.el,r=i.options,d=s.ownerDocument,l;if(o&&!c&&o.parentNode===s){var u=O(o);if(I=s,c=o,$=c.parentNode,_t=c.nextSibling,te=o,qt=r.group,y.dragged=c,wt={target:c,clientX:(e||t).clientX,clientY:(e||t).clientY},Fe=wt.clientX-u.left,je=wt.clientY-u.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,c.style["will-change"]="all",l=function(){if(Y("delayEnded",i,{evt:t}),y.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Ae&&i.nativeDraggable&&(c.draggable=!0),i._triggerDragStart(t,e),L({sortable:i,name:"choose",originalEvent:t}),H(c,r.chosenClass,!0)},r.ignore.split(",").forEach(function(g){Ge(c,g.trim(),ge)}),T(d,"dragover",kt),T(d,"mousemove",kt),T(d,"touchmove",kt),r.supportPointer?(T(d,"pointerup",i._onDrop),!this.nativeDraggable&&T(d,"pointercancel",i._onDrop)):(T(d,"mouseup",i._onDrop),T(d,"touchend",i._onDrop),T(d,"touchcancel",i._onDrop)),Ae&&this.nativeDraggable&&(this.options.touchStartThreshold=4,c.draggable=!0),Y("delayStart",this,{evt:t}),r.delay&&(!r.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Kt||dt))){if(y.eventCanceled){this._onDrop();return}r.supportPointer?(T(d,"pointerup",i._disableDelayedDrag),T(d,"pointercancel",i._disableDelayedDrag)):(T(d,"mouseup",i._disableDelayedDrag),T(d,"touchend",i._disableDelayedDrag),T(d,"touchcancel",i._disableDelayedDrag)),T(d,"mousemove",i._delayedDragTouchMoveHandler),T(d,"touchmove",i._delayedDragTouchMoveHandler),r.supportPointer&&T(d,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,r.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){c&&ge(c),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;k(t,"mouseup",this._disableDelayedDrag),k(t,"touchend",this._disableDelayedDrag),k(t,"touchcancel",this._disableDelayedDrag),k(t,"pointerup",this._disableDelayedDrag),k(t,"pointercancel",this._disableDelayedDrag),k(t,"mousemove",this._delayedDragTouchMoveHandler),k(t,"touchmove",this._delayedDragTouchMoveHandler),k(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?T(document,"pointermove",this._onTouchMove):e?T(document,"touchmove",this._onTouchMove):T(document,"mousemove",this._onTouchMove):(T(c,"dragend",this),T(I,"dragstart",this._onDragStart));try{document.selection?ne(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(St=!1,I&&c){Y("dragStarted",this,{evt:e}),this.nativeDraggable&&T(document,"dragover",Xi);var o=this.options;!t&&H(c,o.dragClass,!1),H(c,o.ghostClass,!0),y.active=this,t&&this._appendGhost(),L({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(J){this._lastX=J.clientX,this._lastY=J.clientY,nn();for(var t=document.elementFromPoint(J.clientX,J.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(J.clientX,J.clientY),t!==e);)e=t;if(c.parentNode[W]._isOutsideThisEl(t),e)do{if(e[W]){var o=void 0;if(o=e[W]._onDragOver({clientX:J.clientX,clientY:J.clientY,target:t,rootEl:e}),o&&!this.options.dragoverBubble)break}t=e}while(e=Ke(e));on()}},_onTouchMove:function(t){if(wt){var e=this.options,o=e.fallbackTolerance,i=e.fallbackOffset,s=t.touches?t.touches[0]:t,r=w&&Ct(w,!0),d=w&&r&&r.a,l=w&&r&&r.d,u=Zt&&B&&Be(B),g=(s.clientX-wt.clientX+i.x)/(d||1)+(u?u[0]-pe[0]:0)/(d||1),h=(s.clientY-wt.clientY+i.y)/(l||1)+(u?u[1]-pe[1]:0)/(l||1);if(!y.active&&!St){if(o&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<o)return;this._onDragStart(t,!0)}if(w){r?(r.e+=g-(me||0),r.f+=h-(he||0)):r={a:1,b:0,c:0,d:1,e:g,f:h};var p="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");v(w,"webkitTransform",p),v(w,"mozTransform",p),v(w,"msTransform",p),v(w,"transform",p),me=g,he=h,J=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!w){var t=this.options.fallbackOnBody?document.body:I,e=O(c,!0,Zt,!0,t),o=this.options;if(Zt){for(B=t;v(B,"position")==="static"&&v(B,"transform")==="none"&&B!==document;)B=B.parentNode;B!==document.body&&B!==document.documentElement?(B===document&&(B=et()),e.top+=B.scrollTop,e.left+=B.scrollLeft):B=et(),pe=Be(B)}w=c.cloneNode(!0),H(w,o.ghostClass,!1),H(w,o.fallbackClass,!0),H(w,o.dragClass,!0),v(w,"transition",""),v(w,"transform",""),v(w,"box-sizing","border-box"),v(w,"margin",0),v(w,"top",e.top),v(w,"left",e.left),v(w,"width",e.width),v(w,"height",e.height),v(w,"opacity","0.8"),v(w,"position",Zt?"absolute":"fixed"),v(w,"zIndex","100000"),v(w,"pointerEvents","none"),y.ghost=w,t.appendChild(w),v(w,"transform-origin",Fe/parseInt(w.style.width)*100+"% "+je/parseInt(w.style.height)*100+"%")}},_onDragStart:function(t,e){var o=this,i=t.dataTransfer,s=o.options;if(Y("dragStart",this,{evt:t}),y.eventCanceled){this._onDrop();return}Y("setupClone",this),y.eventCanceled||(x=Je(c),x.removeAttribute("id"),x.draggable=!1,x.style["will-change"]="",this._hideClone(),H(x,this.options.chosenClass,!1),y.clone=x),o.cloneId=ne(function(){Y("clone",o),!y.eventCanceled&&(o.options.removeCloneOnHide||I.insertBefore(x,c),o._hideClone(),L({sortable:o,name:"clone"}))}),!e&&H(c,s.dragClass,!0),e?(se=!0,o._loopId=setInterval(o._emulateDragOver,50)):(k(document,"mouseup",o._onDrop),k(document,"touchend",o._onDrop),k(document,"touchcancel",o._onDrop),i&&(i.effectAllowed="move",s.setData&&s.setData.call(o,i,c)),T(document,"drop",o),v(c,"transform","translateZ(0)")),St=!0,o._dragStartId=ne(o._dragStarted.bind(o,e,t)),T(document,"selectstart",o),Bt=!0,window.getSelection().removeAllRanges(),Rt&&v(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,o=t.target,i,s,r,d=this.options,l=d.group,u=y.active,g=qt===l,h=d.sort,p=N||u,D,_=this,S=!1;if(ke)return;function z(Pt,an){Y(Pt,_,nt({evt:t,isOwner:g,axis:D?"vertical":"horizontal",revert:r,dragRect:i,targetRect:s,canSort:h,fromSortable:p,target:o,completed:R,onMove:function(Me,rn){return Qt(I,e,c,i,Me,O(Me),t,rn)},changed:q},an))}function ot(){z("dragOverAnimationCapture"),_.captureAnimationState(),_!==p&&p.captureAnimationState()}function R(Pt){return z("dragOverCompleted",{insertion:Pt}),Pt&&(g?u._hideClone():u._showClone(_),_!==p&&(H(c,N?N.options.ghostClass:u.options.ghostClass,!1),H(c,d.ghostClass,!0)),N!==_&&_!==y.active?N=_:_===y.active&&N&&(N=null),p===_&&(_._ignoreWhileAnimating=o),_.animateAll(function(){z("dragOverAnimationComplete"),_._ignoreWhileAnimating=null}),_!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(o===c&&!c.animated||o===e&&!o.animated)&&(Dt=null),!d.dragoverBubble&&!t.rootEl&&o!==document&&(c.parentNode[W]._isOutsideThisEl(t.target),!Pt&&kt(t)),!d.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),S=!0}function q(){K=G(c),ft=G(c,d.draggable),L({sortable:_,name:"change",toEl:e,newIndex:K,newDraggableIndex:ft,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),o=Z(o,d.draggable,e,!0),z("dragOver"),y.eventCanceled)return S;if(c.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||_._ignoreWhileAnimating===o)return R(!1);if(se=!1,u&&!d.disabled&&(g?h||(r=$!==I):N===this||(this.lastPutMode=qt.checkPull(this,u,c,t))&&l.checkPut(this,u,c,t))){if(D=this._getDirection(t,o)==="vertical",i=O(c),z("dragOverValid"),y.eventCanceled)return S;if(r)return $=I,ot(),this._hideClone(),z("revert"),y.eventCanceled||(_t?I.insertBefore(c,_t):I.appendChild(c)),R(!0);var U=Ie(e,d.draggable);if(!U||Vi(t,D,this)&&!U.animated){if(U===c)return R(!1);if(U&&e===t.target&&(o=U),o&&(s=O(o)),Qt(I,e,c,i,o,s,t,!!o)!==!1)return ot(),U&&U.nextSibling?e.insertBefore(c,U.nextSibling):e.appendChild(c),$=e,q(),R(!0)}else if(U&&Ui(t,D,this)){var bt=xt(e,0,d,!0);if(bt===c)return R(!1);if(o=bt,s=O(o),Qt(I,e,c,i,o,s,t,!1)!==!1)return ot(),e.insertBefore(c,bt),$=e,q(),R(!0)}else if(o.parentNode===e){s=O(o);var tt=0,vt,$t=c.parentNode!==e,V=!Ri(c.animated&&c.toRect||i,o.animated&&o.toRect||s,D),Mt=D?"top":"left",ut=Ne(o,"top","top")||Ne(c,"top","top"),Ot=ut?ut.scrollTop:void 0;Dt!==o&&(vt=s[Mt],Wt=!1,Jt=!V&&d.invertSwap||$t),tt=Hi(t,o,s,D,V?1:d.swapThreshold,d.invertedSwapThreshold==null?d.swapThreshold:d.invertedSwapThreshold,Jt,Dt===o);var it;if(tt!==0){var yt=G(c);do yt-=tt,it=$.children[yt];while(it&&(v(it,"display")==="none"||it===w))}if(tt===0||it===o)return R(!1);Dt=o,Yt=tt;var At=o.nextElementSibling,ct=!1;ct=tt===1;var zt=Qt(I,e,c,i,o,s,t,ct);if(zt!==!1)return(zt===1||zt===-1)&&(ct=zt===1),ke=!0,setTimeout(Wi,30),ot(),ct&&!At?e.appendChild(c):o.parentNode.insertBefore(c,ct?At:o),ut&&qe(ut,0,Ot-ut.scrollTop),$=c.parentNode,vt!==void 0&&!Jt&&(ee=Math.abs(vt-O(o)[Mt])),q(),R(!0)}if(e.contains(c))return R(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){k(document,"mousemove",this._onTouchMove),k(document,"touchmove",this._onTouchMove),k(document,"pointermove",this._onTouchMove),k(document,"dragover",kt),k(document,"mousemove",kt),k(document,"touchmove",kt)},_offUpEvents:function(){var t=this.el.ownerDocument;k(t,"mouseup",this._onDrop),k(t,"touchend",this._onDrop),k(t,"pointerup",this._onDrop),k(t,"pointercancel",this._onDrop),k(t,"touchcancel",this._onDrop),k(document,"selectstart",this)},_onDrop:function(t){var e=this.el,o=this.options;if(K=G(c),ft=G(c,o.draggable),Y("drop",this,{evt:t}),$=c&&c.parentNode,K=G(c),ft=G(c,o.draggable),y.eventCanceled){this._nulling();return}St=!1,Jt=!1,Wt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),_e(this.cloneId),_e(this._dragStartId),this.nativeDraggable&&(k(document,"drop",this),k(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Rt&&v(document.body,"user-select",""),v(c,"transform",""),t&&(Bt&&(t.cancelable&&t.preventDefault(),!o.dropBubble&&t.stopPropagation()),w&&w.parentNode&&w.parentNode.removeChild(w),(I===$||N&&N.lastPutMode!=="clone")&&x&&x.parentNode&&x.parentNode.removeChild(x),c&&(this.nativeDraggable&&k(c,"dragend",this),ge(c),c.style["will-change"]="",Bt&&!St&&H(c,N?N.options.ghostClass:this.options.ghostClass,!1),H(c,this.options.chosenClass,!1),L({sortable:this,name:"unchoose",toEl:$,newIndex:null,newDraggableIndex:null,originalEvent:t}),I!==$?(K>=0&&(L({rootEl:$,name:"add",toEl:$,fromEl:I,originalEvent:t}),L({sortable:this,name:"remove",toEl:$,originalEvent:t}),L({rootEl:$,name:"sort",toEl:$,fromEl:I,originalEvent:t}),L({sortable:this,name:"sort",toEl:$,originalEvent:t})),N&&N.save()):K!==Et&&K>=0&&(L({sortable:this,name:"update",toEl:$,originalEvent:t}),L({sortable:this,name:"sort",toEl:$,originalEvent:t})),y.active&&((K==null||K===-1)&&(K=Et,ft=Xt),L({sortable:this,name:"end",toEl:$,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Y("nulling",this),I=c=$=w=_t=x=te=ht=wt=J=Bt=K=ft=Et=Xt=Dt=Yt=N=qt=y.dragged=y.ghost=y.clone=y.active=null;var t=this.el;re.forEach(function(e){t.contains(e)&&(e.checked=!0)}),re.length=me=he=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":c&&(this._onDragOver(t),Yi(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,o=this.el.children,i=0,s=o.length,r=this.options;i<s;i++)e=o[i],Z(e,r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||Gi(e));return t},sort:function(t,e){var o={},i=this.el;this.toArray().forEach(function(s,r){var d=i.children[r];Z(d,this.options.draggable,i,!1)&&(o[s]=d)},this),e&&this.captureAnimationState(),t.forEach(function(s){o[s]&&(i.removeChild(o[s]),i.appendChild(o[s]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return Z(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var o=this.options;if(e===void 0)return o[t];var i=Gt.modifyOption(this,t,e);typeof i<"u"?o[t]=i:o[t]=e,t==="group"&&en(o)},destroy:function(){Y("destroy",this);var t=this.el;t[W]=null,k(t,"mousedown",this._onTapStart),k(t,"touchstart",this._onTapStart),k(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(k(t,"dragover",this),k(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ae.splice(ae.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ht){if(Y("hideClone",this),y.eventCanceled)return;v(x,"display","none"),this.options.removeCloneOnHide&&x.parentNode&&x.parentNode.removeChild(x),ht=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ht){if(Y("showClone",this),y.eventCanceled)return;c.parentNode==I&&!this.options.group.revertClone?I.insertBefore(x,c):_t?I.insertBefore(x,_t):I.appendChild(x),this.options.group.revertClone&&this.animate(c,x),v(x,"display",""),ht=!1}}};function Yi(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function Qt(n,t,e,o,i,s,r,d){var l,u=n[W],g=u.options.onMove,h;return window.CustomEvent&&!dt&&!Kt?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=n,l.dragged=e,l.draggedRect=o,l.related=i||t,l.relatedRect=s||O(t),l.willInsertAfter=d,l.originalEvent=r,n.dispatchEvent(l),g&&(h=g.call(u,l,r)),h}function ge(n){n.draggable=!1}function Wi(){ke=!1}function Ui(n,t,e){var o=O(xt(e.el,0,e.options,!0)),i=Ze(e.el,e.options,w),s=10;return t?n.clientX<i.left-s||n.clientY<o.top&&n.clientX<o.right:n.clientY<i.top-s||n.clientY<o.bottom&&n.clientX<o.left}function Vi(n,t,e){var o=O(Ie(e.el,e.options.draggable)),i=Ze(e.el,e.options,w),s=10;return t?n.clientX>i.right+s||n.clientY>o.bottom&&n.clientX>o.left:n.clientY>i.bottom+s||n.clientX>o.right&&n.clientY>o.top}function Hi(n,t,e,o,i,s,r,d){var l=o?n.clientY:n.clientX,u=o?e.height:e.width,g=o?e.top:e.left,h=o?e.bottom:e.right,p=!1;if(!r){if(d&&ee<u*i){if(!Wt&&(Yt===1?l>g+u*s/2:l<h-u*s/2)&&(Wt=!0),Wt)p=!0;else if(Yt===1?l<g+ee:l>h-ee)return-Yt}else if(l>g+u*(1-i)/2&&l<h-u*(1-i)/2)return Ki(t)}return p=p||r,p&&(l<g+u*s/2||l>h-u*s/2)?l>g+u/2?1:-1:0}function Ki(n){return G(c)<G(n)?1:-1}function Gi(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,e=t.length,o=0;e--;)o+=t.charCodeAt(e);return o.toString(36)}function zi(n){re.length=0;for(var t=n.getElementsByTagName("input"),e=t.length;e--;){var o=t[e];o.checked&&re.push(o)}}function ne(n){return setTimeout(n,0)}function _e(n){return clearTimeout(n)}de&&T(document,"touchmove",function(n){(y.active||St)&&n.cancelable&&n.preventDefault()});y.utils={on:T,off:k,css:v,find:Ge,is:function(t,e){return!!Z(t,e,t,!1)},extend:Mi,throttle:ze,closest:Z,toggleClass:H,clone:Je,index:G,nextTick:ne,cancelNextTick:_e,detectDirection:tn,getChild:xt,expando:W};y.get=function(n){return n[W]};y.mount=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(y.utils=nt(nt({},y.utils),o.utils)),Gt.mount(o)})};y.create=function(n,t){return new y(n,t)};y.version=xi;var M=[],Ft,Te,De=!1,be,ve,le,jt;function qi(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return n.prototype={dragStarted:function(e){var o=e.originalEvent;this.sortable.nativeDraggable?T(document,"dragover",this._handleAutoScroll):this.options.supportPointer?T(document,"pointermove",this._handleFallbackAutoScroll):o.touches?T(document,"touchmove",this._handleFallbackAutoScroll):T(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var o=e.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?k(document,"dragover",this._handleAutoScroll):(k(document,"pointermove",this._handleFallbackAutoScroll),k(document,"touchmove",this._handleFallbackAutoScroll),k(document,"mousemove",this._handleFallbackAutoScroll)),Le(),oe(),Oi()},nulling:function(){le=Te=Ft=De=jt=be=ve=null,M.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,o){var i=this,s=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,d=document.elementFromPoint(s,r);if(le=e,o||this.options.forceAutoScrollFallback||Kt||dt||Rt){ye(e,this.options,d,o);var l=gt(d,!0);De&&(!jt||s!==be||r!==ve)&&(jt&&Le(),jt=setInterval(function(){var u=gt(document.elementFromPoint(s,r),!0);u!==l&&(l=u,oe()),ye(e,i.options,u,o)},10),be=s,ve=r)}else{if(!this.options.bubbleScroll||gt(d,!0)===et()){oe();return}ye(e,this.options,gt(d,!1),!1)}}},lt(n,{pluginName:"scroll",initializeByDefault:!0})}function oe(){M.forEach(function(n){clearInterval(n.pid)}),M=[]}function Le(){clearInterval(jt)}var ye=ze(function(n,t,e,o){if(t.scroll){var i=(n.touches?n.touches[0]:n).clientX,s=(n.touches?n.touches[0]:n).clientY,r=t.scrollSensitivity,d=t.scrollSpeed,l=et(),u=!1,g;Te!==e&&(Te=e,oe(),Ft=t.scroll,g=t.scrollFn,Ft===!0&&(Ft=gt(e,!0)));var h=0,p=Ft;do{var D=p,_=O(D),S=_.top,z=_.bottom,ot=_.left,R=_.right,q=_.width,U=_.height,bt=void 0,tt=void 0,vt=D.scrollWidth,$t=D.scrollHeight,V=v(D),Mt=D.scrollLeft,ut=D.scrollTop;D===l?(bt=q<vt&&(V.overflowX==="auto"||V.overflowX==="scroll"||V.overflowX==="visible"),tt=U<$t&&(V.overflowY==="auto"||V.overflowY==="scroll"||V.overflowY==="visible")):(bt=q<vt&&(V.overflowX==="auto"||V.overflowX==="scroll"),tt=U<$t&&(V.overflowY==="auto"||V.overflowY==="scroll"));var Ot=bt&&(Math.abs(R-i)<=r&&Mt+q<vt)-(Math.abs(ot-i)<=r&&!!Mt),it=tt&&(Math.abs(z-s)<=r&&ut+U<$t)-(Math.abs(S-s)<=r&&!!ut);if(!M[h])for(var yt=0;yt<=h;yt++)M[yt]||(M[yt]={});(M[h].vx!=Ot||M[h].vy!=it||M[h].el!==D)&&(M[h].el=D,M[h].vx=Ot,M[h].vy=it,clearInterval(M[h].pid),(Ot!=0||it!=0)&&(u=!0,M[h].pid=setInterval((function(){o&&this.layer===0&&y.active._onTouchMove(le);var At=M[this.layer].vy?M[this.layer].vy*d:0,ct=M[this.layer].vx?M[this.layer].vx*d:0;typeof g=="function"&&g.call(y.dragged.parentNode[W],ct,At,n,le,M[this.layer].el)!=="continue"||qe(M[this.layer].el,ct,At)}).bind({layer:h}),24))),h++}while(t.bubbleScroll&&p!==l&&(p=gt(p,!1)));De=u}},30),sn=function(t){var e=t.originalEvent,o=t.putSortable,i=t.dragEl,s=t.activeSortable,r=t.dispatchSortableEvent,d=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(e){var u=o||s;d();var g=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,h=document.elementFromPoint(g.clientX,g.clientY);l(),u&&!u.el.contains(h)&&(r("spill"),this.onSpill({dragEl:i,putSortable:o}))}};function xe(){}xe.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,o=t.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var i=xt(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(e,i):this.sortable.el.appendChild(e),this.sortable.animateAll(),o&&o.animateAll()},drop:sn};lt(xe,{pluginName:"revertOnSpill"});function $e(){}$e.prototype={onSpill:function(t){var e=t.dragEl,o=t.putSortable,i=o||this.sortable;i.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),i.animateAll()},drop:sn};lt($e,{pluginName:"removeOnSpill"});y.mount(new qi);y.mount($e,xe);const Ji={class:"modal modal-lg fade show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},Zi={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},Qi={class:"modal-content"},ts={class:"modal-header"},es={class:"modal-title"},ns={class:"modal-body"},os={class:"form-floating mb-3"},is={class:"form-floating mb-3"},ss={class:"form-floating mb-3"},as={class:"form-floating mb-3"},rs={class:"mb-3"},ls={class:"d-flex flex-wrap gap-1"},ds=["value"],us={class:"mb-3"},cs={class:"d-flex gap-2"},fs={class:"mb-3"},ms={class:"d-flex flex-wrap gap-2"},hs=["value"],ps={class:"mb-3"},gs={class:"form-label fw-bold"},bs={class:"text-muted ms-2"},vs={class:"input-group mb-2"},ys={class:"list-group",ref:"subtasksList"},ws=["onUpdate:modelValue"],ks=["onClick"],_s={class:"modal-footer"},Ts={props:{task:Object,columnId:Number},computed:{completedSubtasks(){return this.local.subtasks.filter(n=>n.done).length}},data(){var t;return{store:Ht(),availableLabels:["development","bug","client","urgent","design","finance"],local:this.task?{...this.task,tagIds:((t=this.task.tags)==null?void 0:t.map(e=>e.id))??[],subtasks:this.task.subtasks??[]}:{title:"",description:"",priority:"low",dueDate:"",tagIds:[],labels:["development"],columnId:this.columnId,subtasks:[]},newSubtask:"",newTagName:"",newTagColor:"#999999"}},mounted(){this.initSortable()},methods:{initSortable(){this.$refs.subtasksList&&y.create(this.$refs.subtasksList,{animation:150,handle:".drag-handle",onEnd:n=>{const t=this.local.subtasks.splice(n.oldIndex,1)[0];this.local.subtasks.splice(n.newIndex,0,t)}})},addSubtask(){this.newSubtask.trim()&&(this.local.subtasks.push({id:Date.now(),text:this.newSubtask.trim(),done:!1}),this.newSubtask="")},removeSubtask(n){this.local.subtasks.splice(n,1)},async addTag(){if(!this.newTagName.trim())return;const n=await this.store.createTag(this.store.board.uuid,this.newTagName,this.newTagColor);this.local.tagIds.push(n.id),this.newTagName="",this.newTagColor="#999999"},async submit(){this.local.columnId=this.columnId,this.local.tagIds=[...this.local.tagIds],this.local.id?(await this.store.updateTask(this.local),this.$emit("edit-task",this.local)):(await this.store.createTask(this.store.board.uuid,this.local),this.$emit("add-task",this.local)),this.$emit("close")}}},Ds=Object.assign(Ts,{__name:"TaskModal",setup(n){return(t,e)=>(f(),m("div",Ji,[a("div",Zi,[a("div",Qi,[a("div",ts,[a("h5",es,b(n.task?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É":"–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞"),1),a("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=o=>t.$emit("close"))})]),a("div",ns,[a("form",{onSubmit:e[13]||(e[13]=st((...o)=>t.submit&&t.submit(...o),["prevent"]))},[a("div",os,[X(a("input",{type:"text",class:"form-control",id:"taskTitle",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ","onUpdate:modelValue":e[1]||(e[1]=o=>t.local.title=o),required:""},null,512),[[Q,t.local.title]]),e[16]||(e[16]=a("label",{for:"taskTitle"},"–ù–∞–∑–≤–∞–Ω–∏–µ",-1))]),a("div",is,[X(a("textarea",{class:"form-control",id:"taskDescription",placeholder:"–û–ø–∏—Å–∞–Ω–∏–µ",style:{height:"120px"},"onUpdate:modelValue":e[2]||(e[2]=o=>t.local.description=o)},null,512),[[Q,t.local.description]]),e[17]||(e[17]=a("label",{for:"taskDescription"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1))]),n.task?(f(),m(P,{key:0},[n.task.type===1?(f(),at(no,{key:0,card:n.task},null,8,["card"])):A("",!0),n.task.type===2?(f(),at(po,{key:1,card:n.task},null,8,["card"])):A("",!0),n.task.type===3?(f(),at(wo,{key:2,card:n.task},null,8,["card"])):A("",!0),n.task.type===4?(f(),at(xo,{key:3,card:n.task},null,8,["card"])):A("",!0),n.task.type===5?(f(),at(Ro,{key:4,card:n.task},null,8,["card"])):A("",!0)],64)):A("",!0),a("div",ss,[X(a("select",{class:"form-select",id:"taskPriority","onUpdate:modelValue":e[3]||(e[3]=o=>t.local.priority=o)},[...e[18]||(e[18]=[a("option",{value:"low"},"–ù–∏–∑–∫–∏–π",-1),a("option",{value:"medium"},"–°—Ä–µ–¥–Ω–∏–π",-1),a("option",{value:"high"},"–í—ã—Å–æ–∫–∏–π",-1)])],512),[[ln,t.local.priority]]),e[19]||(e[19]=a("label",{for:"taskPriority"},"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç",-1))]),a("div",as,[X(a("input",{type:"date",class:"form-control",id:"taskDueDate",placeholder:"–î–∞—Ç–∞","onUpdate:modelValue":e[4]||(e[4]=o=>t.local.dueDate=o)},null,512),[[Q,t.local.dueDate]]),e[20]||(e[20]=a("label",{for:"taskDueDate"},"–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",-1))]),a("div",rs,[e[21]||(e[21]=a("label",{class:"form-label"},"–¢–µ–≥–∏",-1)),a("div",ls,[(f(!0),m(P,null,F(t.store.tags,o=>(f(),m("label",{key:o.id,class:"badge d-flex align-items-center px-2 py-1 border border-secondary text-white",style:Se({background:o.color,cursor:"pointer"})},[X(a("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[5]||(e[5]=i=>t.local.tagIds=i),class:"form-check-input me-2"},null,8,ds),[[ue,t.local.tagIds]]),E(" "+b(o.name),1)],4))),128))])]),a("div",us,[e[22]||(e[22]=a("label",{class:"form-label"},"–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥",-1)),a("div",cs,[X(a("input",{class:"form-control","onUpdate:modelValue":e[6]||(e[6]=o=>t.newTagName=o),placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞"},null,512),[[Q,t.newTagName]]),X(a("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>t.newTagColor=o),type:"color",class:"form-control form-control-color",style:{width:"60px"}},null,512),[[Q,t.newTagColor]]),a("button",{type:"button",class:"btn btn-primary",onClick:e[8]||(e[8]=(...o)=>t.addTag&&t.addTag(...o))}," –î–æ–±–∞–≤–∏—Ç—å ")])]),a("div",fs,[e[23]||(e[23]=a("label",{class:"form-label"},"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏",-1)),a("div",ms,[(f(!0),m(P,null,F(t.availableLabels,o=>(f(),m("label",{key:o,class:"badge d-flex align-items-center px-2 py-1 border border-primary text-primary",style:{cursor:"pointer"}},[X(a("input",{type:"checkbox",class:"form-check-input me-2",value:o,"onUpdate:modelValue":e[9]||(e[9]=i=>t.local.labels=i)},null,8,hs),[[ue,t.local.labels]]),E(" "+b(o),1)]))),128))])]),a("div",ps,[a("label",gs,[e[24]||(e[24]=E(" –ü–æ–¥–∑–∞–¥–∞—á–∏ ",-1)),a("span",bs,b(t.completedSubtasks)+" / "+b(t.local.subtasks.length),1)]),a("div",vs,[X(a("input",{type:"text",class:"form-control",placeholder:"–ù–æ–≤–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞","onUpdate:modelValue":e[10]||(e[10]=o=>t.newSubtask=o),onKeyup:e[11]||(e[11]=Ut((...o)=>t.addSubtask&&t.addSubtask(...o),["enter"]))},null,544),[[Q,t.newSubtask]]),a("button",{class:"btn btn-outline-primary",type:"button",onClick:e[12]||(e[12]=(...o)=>t.addSubtask&&t.addSubtask(...o))}," –î–æ–±–∞–≤–∏—Ç—å ")]),a("ul",ys,[(f(!0),m(P,null,F(t.local.subtasks,(o,i)=>(f(),m("li",{key:o.id,class:It(["list-group-item d-flex align-items-center",{"bg-success bg-opacity-10":o.done}])},[e[25]||(e[25]=a("span",{class:"drag-handle me-3",style:{cursor:"grab"}},"‚ò∞",-1)),X(a("input",{type:"checkbox",class:"form-check-input me-2","onUpdate:modelValue":s=>o.done=s},null,8,ws),[[ue,o.done]]),a("span",{class:It(["flex-grow-1",{"text-decoration-line-through text-success":o.done}])},b(o.text),3),a("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:s=>t.removeSubtask(i)}," ‚úï ",8,ks)],2))),128))],512)]),t.local.id?(f(),m(P,{key:1},[e[26]||(e[26]=a("h6",{class:"fw-bold mb-3"},"–í–ª–æ–∂–µ–Ω–∏—è –∫ –∑–∞–¥–∞—á–µ",-1)),pt(Ti,{taskId:t.local.id},null,8,["taskId"]),pt(vi,{taskId:t.local.id},null,8,["taskId"]),e[27]||(e[27]=a("h6",{class:"fw-bold my-3"},"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∑–∞–¥–∞—á–µ",-1)),pt(li,{taskId:t.local.id},null,8,["taskId"]),pt(Qo,{taskId:t.local.id},null,8,["taskId"])],64)):A("",!0)],32)]),a("div",_s,[a("button",{class:"btn btn-secondary",onClick:e[14]||(e[14]=o=>t.$emit("close"))},"–û—Ç–º–µ–Ω–∞"),a("button",{class:"btn btn-primary",onClick:e[15]||(e[15]=(...o)=>t.submit&&t.submit(...o))},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å")])])])]))}}),Ss={data(){return{title:""}},methods:{save(){this.$emit("save",this.title)}}},Es={class:"modal-backdrop"},Cs={class:"modal-window"},Is={class:"d-flex justify-content-end gap-2"};function xs(n,t,e,o,i,s){return f(),m("div",Es,[a("div",Cs,[t[4]||(t[4]=a("h3",null,"–ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞",-1)),a("form",{onSubmit:t[2]||(t[2]=st((...r)=>s.save&&s.save(...r),["prevent"]))},[X(a("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>i.title=r),class:"form-control mb-3",placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ",required:""},null,512),[[Q,i.title]]),a("div",Is,[a("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=r=>n.$emit("close"))},"–û—Ç–º–µ–Ω–∞"),t[3]||(t[3]=a("button",{type:"submit",class:"btn btn-primary"},"–î–æ–±–∞–≤–∏—Ç—å",-1))])],32)])])}const $s=j(Ss,[["render",xs]]),Ms=Vt("authToken",{state:()=>({token:null,loading:!1}),actions:{async fetchToken(n){this.loading=!0;try{const t=await C.post("/api/token",{uuid:n});this.token=t.data.token}catch(t){console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞",t)}finally{this.loading=!1}}}}),Os={data(){return{store:Ms(),kanbanStore:Ht()}},mounted(){this.store.fetchToken(this.kanbanStore.board.uuid)},methods:{copyToken(){navigator.clipboard.writeText(this.store.token),alert("–¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω")}}},As={class:"modal fade show d-block",tabindex:"-1"},Ps={class:"modal-dialog"},Ns={class:"modal-content"},Bs={class:"modal-header"},Fs={class:"modal-body"},js={key:0,class:"text-center py-3"},Rs={key:1},Ls={class:"bg-light p-3 rounded border"},Xs={class:"modal-footer"};function Ys(n,t,e,o,i,s){return f(),m(P,null,[a("div",As,[a("div",Ps,[a("div",Ns,[a("div",Bs,[t[3]||(t[3]=a("h5",{class:"modal-title"},[a("i",{class:"fa-solid fa-key me-2"}),E(" –í–∞—à —Ç–æ–∫–µ–Ω ")],-1)),a("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=r=>n.$emit("close"))})]),a("div",Fs,[i.store.loading?(f(),m("div",js,[...t[4]||(t[4]=[a("div",{class:"spinner-border text-primary"},null,-1),a("p",{class:"mt-2"},"–ó–∞–≥—Ä—É–∑–∫–∞...",-1)])])):(f(),m("div",Rs,[t[6]||(t[6]=a("label",{class:"form-label fw-bold"},"–í–∞—à —Ç–æ–∫–µ–Ω:",-1)),a("pre",Ls,b(i.store.token),1),t[7]||(t[7]=a("p",{class:"mb-2 small"},[E("–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫ API "),a("a",{class:"underline fw-bold text-primary",href:"https://packagist.org/packages/exxxar/kanban-laravel",target:"_blank"},"—Ç—É—Ç")],-1)),a("button",{class:"btn btn-outline-secondary mt-2",onClick:t[1]||(t[1]=(...r)=>s.copyToken&&s.copyToken(...r))},[...t[5]||(t[5]=[a("i",{class:"fa-solid fa-copy me-2"},null,-1),E(" –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ",-1)])])]))]),a("div",Xs,[a("button",{class:"btn btn-secondary",onClick:t[2]||(t[2]=r=>n.$emit("close"))}," –ó–∞–∫—Ä—ã—Ç—å ")])])])]),t[8]||(t[8]=a("div",{class:"modal-backdrop fade show"},null,-1))],64)}const Ws=j(Os,[["render",Ys],["__scopeId","data-v-4fd2debe"]]),Us={components:{KanbanColumn:Vn,TaskModal:Ds,ColumnModal:$s,ConfirmModal:Ye,TokenModal:Ws},props:{initialBoard:Object},data(){return{showTokenModal:!1,showDeleteModal:!1,showTaskModal:!1,showColumnModal:!1,editingTask:null,currentColumnId:null,dragIndex:null,store:Ht(),editingBoardTitle:!1,localBoardTitle:this.initialBoard.title}},mounted(){this.store.columns=this.initialBoard.columns,this.store.board=this.initialBoard},methods:{openTokenModal(){this.showTokenModal=!0},exportData(){window.open(`/api/boards/${this.initialBoard.id}/export`,"_blank")},onDragStart(n){this.dragIndex=n},onDrop(n){this.dragIndex!==null&&(this.store.moveColumn(this.dragIndex,n),this.dragIndex=null)},openTaskModal(n,t=null){this.currentColumnId=n,this.editingTask=t,t&&(t.last_viewed_at||this.store.markTaskViewed(t.id)),this.showTaskModal=!0},closeTaskModal(){this.showTaskModal=!1,this.editingTask=null},async saveTask(n){n.id?await this.updateTask(n):await this.createTask(this.store.board.uuid,n),this.closeTaskModal()},openColumnModal(){this.showColumnModal=!0},closeColumnModal(){this.showColumnModal=!1},addColumn(n){this.store.createColumn(this.store.board.uuid,n),this.closeColumnModal()},clearBoard(){this.store.clearBoard()},copyLink(){navigator.clipboard.writeText(window.location.href),alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!")},startEditingBoardTitle(){this.localBoardTitle=this.store.board.title,this.editingBoardTitle=!0},async saveBoardTitle(){this.localBoardTitle.trim()&&(await this.store.renameBoard(this.store.board.uuid,this.localBoardTitle),this.editingBoardTitle=!1)},cancelBoardEditing(){this.localBoardTitle=this.store.board.title,this.editingBoardTitle=!1}}},Vs={class:"container","data-board-root":""},Hs={class:"d-flex justify-content-between align-items-center my-3 p-3"},Ks={class:"d-flex align-items-center gap-2"},Gs={key:1,class:"d-flex align-items-center gap-2"},zs={class:"btn-group"},qs={class:"kanban-board d-flex gap-3"},Js=["onDragstart","onDrop"];function Zs(n,t,e,o,i,s){var h;const r=mt("KanbanColumn"),d=mt("TaskModal"),l=mt("ColumnModal"),u=mt("ConfirmModal"),g=mt("TokenModal");return f(),m("div",Vs,[a("header",Hs,[a("div",Ks,[i.editingBoardTitle?(f(),m("div",Gs,[X(a("input",{"onUpdate:modelValue":t[1]||(t[1]=p=>i.localBoardTitle=p),class:"form-control form-control-sm",onKeyup:[t[2]||(t[2]=Ut((...p)=>s.saveBoardTitle&&s.saveBoardTitle(...p),["enter"])),t[3]||(t[3]=Ut((...p)=>s.cancelBoardEditing&&s.cancelBoardEditing(...p),["esc"]))],autofocus:""},null,544),[[Q,i.localBoardTitle]]),a("button",{class:"btn btn-sm btn-primary",onClick:t[4]||(t[4]=(...p)=>s.saveBoardTitle&&s.saveBoardTitle(...p))},"‚úî")])):(f(),m("h2",{key:0,class:"h3 m-0",onDblclick:t[0]||(t[0]=(...p)=>s.startEditingBoardTitle&&s.startEditingBoardTitle(...p))},[t[14]||(t[14]=a("i",{class:"fas fa-tasks"},null,-1)),E(" "+b(((h=i.store.board)==null?void 0:h.title)||e.initialBoard.title),1)],32))]),a("div",zs,[a("button",{class:"btn btn-secondary",onClick:t[5]||(t[5]=(...p)=>s.copyLink&&s.copyLink(...p))},[...t[15]||(t[15]=[a("i",{class:"fas fa-link"},null,-1)])]),a("button",{class:"btn btn-primary d-flex align-items-center gap-2",onClick:t[6]||(t[6]=(...p)=>s.openTokenModal&&s.openTokenModal(...p))},[...t[16]||(t[16]=[a("i",{class:"fa-solid fa-key"},null,-1)])]),a("button",{class:"btn btn-secondary",onClick:t[7]||(t[7]=(...p)=>s.exportData&&s.exportData(...p))},[...t[17]||(t[17]=[a("i",{class:"fas fa-file-export"},null,-1)])]),a("button",{class:"btn btn-primary",onClick:t[8]||(t[8]=(...p)=>s.openColumnModal&&s.openColumnModal(...p))},[...t[18]||(t[18]=[a("i",{class:"fas fa-plus"},null,-1)])]),a("button",{class:"btn btn-danger",onClick:t[9]||(t[9]=p=>i.showDeleteModal=!0)},[...t[19]||(t[19]=[a("i",{class:"fas fa-trash-alt"},null,-1)])])])]),a("div",qs,[(f(!0),m(P,null,F(i.store.columns,(p,D)=>(f(),m("div",{key:(p==null?void 0:p.id)||"column"+D,class:"kanban-column-wrapper"},[pt(r,{column:p,onAddTask:s.openTaskModal},{head:dn(()=>[a("button",{draggable:"true",onDragstart:_=>s.onDragStart(D),onDragover:t[10]||(t[10]=st(()=>{},["prevent"])),onDrop:_=>s.onDrop(D),class:"w-100 btn btn-primary mb-2"},null,40,Js)]),_:2},1032,["column","onAddTask"])]))),128))]),i.showTaskModal?(f(),at(d,{key:0,task:i.editingTask,"column-id":i.currentColumnId,onClose:s.closeTaskModal,onSave:s.saveTask},null,8,["task","column-id","onClose","onSave"])):A("",!0),i.showColumnModal?(f(),at(l,{key:1,onClose:s.closeColumnModal,onSave:s.addColumn},null,8,["onClose","onSave"])):A("",!0),pt(u,{show:i.showDeleteModal,"onUpdate:show":t[11]||(t[11]=p=>i.showDeleteModal=p),title:"–£–¥–∞–ª–∏—Ç—å –¥–æ—Å–∫—É?",description:"–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –≤—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∏.",onAccept:s.clearBoard,onReject:t[12]||(t[12]=p=>i.showDeleteModal=!1)},null,8,["show","onAccept"]),i.showTokenModal?(f(),at(g,{key:2,onClose:t[13]||(t[13]=p=>i.showTokenModal=!1)})):A("",!0)])}const Qs=j(Us,[["render",Zs]]),ta=Vt("boardTemplate",{state:()=>({templates:[],loading:!1}),actions:{async loadTemplates(){const{data:n}=await C.get("/api/boards/choose-template");this.templates=n},async applyTemplate(n,t){this.loading=!0,await C.post(`/api/boards/${n}/apply-template`,{template:t}),this.loading=!1}}}),ea={props:{board:Object,vapidPublicKey:String},components:{KanbanBoard:Qs},data(){return{store:Ht(),templateStore:ta(),progress:0}},async mounted(){(!this.board.columns||this.board.columns.length===0)&&(await this.templateStore.loadTemplates(),new bootstrap.Modal(document.getElementById("templateModal"),{backdrop:"static",keyboard:!1}).show()),this.initPush(),this.progress=0,setInterval(()=>{this.progress+=100/600,this.progress>=100&&(this.progress=100)},100),setInterval(async()=>{await this.store.loadBoard(this.board.uuid),this.progress=0},6e4)},methods:{async selectTemplate(n){await this.templateStore.applyTemplate(this.board.uuid,n),bootstrap.Modal.getInstance(document.getElementById("templateModal")).hide(),await this.store.loadBoard(this.board.uuid)},installPWA(){window.installPWA()},async initPush(){if(!("serviceWorker"in navigator)||!("PushManager"in window)){console.warn("Push notifications not supported");return}const n=await navigator.serviceWorker.register("/sw.js");if(await Notification.requestPermission()!=="granted"){console.warn("User denied notifications");return}const e=await n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.vapidPublicKey});await axios.post("/api/push/subscribe",e)}}},na={class:"d-flex flex-column min-vh-100"},oa={class:"flex-grow-1"},ia={class:"modal fade",id:"templateModal",tabindex:"-1","aria-hidden":"true"},sa={class:"modal-dialog modal-dialog-centered modal-lg"},aa={class:"modal-content"},ra={class:"modal-body"},la={class:"template-list"},da=["onClick"],ua={class:"template-title"},ca={key:0,class:"loading"},fa={class:"modal fade",id:"installPwaModal",tabindex:"-1","aria-hidden":"true"},ma={class:"modal-dialog modal-dialog-centered"},ha={class:"modal-content"},pa={class:"modal-footer"};function ga(n,t,e,o,i,s){const r=mt("KanbanBoard");return f(),m(P,null,[a("div",{class:"refresh-progress",style:Se({width:i.progress+"%"})},null,4),a("div",na,[a("main",oa,[pt(r,{"initial-board":e.board},null,8,["initial-board"])]),t[1]||(t[1]=un('<footer class="text-light py-4 mt-auto"><div class="container text-center"><h2 class="kanbancrm-logo mb-3"><i class="fa-solid fa-layer-group me-2"></i> KanbanCRM </h2><p class="mb-1">¬© 2026 KanbanCRM. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p><p class="small text-white">–°–¥–µ–ª–∞–Ω–æ —Å <i class="fa-solid fa-heart text-danger"></i> –≤ –º–∏—Ä–µ –ê–π–¢–∏</p></div></footer>',1))]),a("div",ia,[a("div",sa,[a("div",aa,[a("div",ra,[a("div",la,[(f(!0),m(P,null,F(i.templateStore.templates,d=>(f(),m("div",{key:d.id,class:"template-card",onClick:l=>s.selectTemplate(d.id)},[a("i",{class:It(["fa",d.icon,"template-icon"])},null,2),a("div",ua,b(d.title),1)],8,da))),128))]),i.templateStore.loading?(f(),m("div",ca," –°–æ–∑–¥–∞—ë–º –¥–æ—Å–∫—É... ")):A("",!0)])])])]),a("div",fa,[a("div",ma,[a("div",ha,[t[3]||(t[3]=a("div",{class:"modal-header"},[a("h5",{class:"modal-title"},"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t[4]||(t[4]=a("div",{class:"modal-body"},[a("p",null,"–í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Kanban –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–≥–æ –ø—Ä—è–º–æ —Å —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞.")],-1)),a("div",pa,[t[2]||(t[2]=a("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"–ü–æ–∑–∂–µ",-1)),a("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...d)=>s.installPWA&&s.installPWA(...d))},"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å")])])])])],64)}const wa=j(ea,[["render",ga]]);export{wa as default};
